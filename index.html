
<!DOCTYPE html>
<html>
	<head>
		<title>Book Arranger</title>
		<link rel="stylesheet" href="main.css">

		<script type="module">

			import { Placement } from './js/Placement.js'
			import { PatternPage } from './js/PatternPage.js'

			customElements.define("pattern-page", PatternPage);
			customElements.define("arranger-placement", Placement);

			const getAllPlacements = () => {
				
				let allPlacements = [];

				const e = document.querySelector("#pattern-preview")

				for (const page of e.children) {
					const placements = page.shadowRoot.querySelector(".preview-page").children

					for (const placement of placements) {
						allPlacements.push(placement);
						//placement.shadowRoot.querySelector(".placement").style.width = "100px";
						//console.log(placement.shadowRoot.querySelector(".placement"));
					}
					
				}

				return allPlacements;
				
			}

			/** Button Methods */
			window.addPage = () => {

				const pageWidth = document.querySelector("#new-page-width").value;
				const pageHeight = document.querySelector("#new-page-height").value;

				const pattern_page = document.createElement("pattern-page");
				pattern_page.setAttribute('width', pageWidth);
				pattern_page.setAttribute('height', pageHeight);

				document.querySelector("#pattern-preview").appendChild(pattern_page);
			}

			window.sourcePageWidthChanged = (newWidth) => {
			}

			window.sourcePageHeightChanged = (newHeight) => {
			}


			window.updatePlacementWidths = (newWidth) => {
				const placements = getAllPlacements();

				for (const placement of placements) {
					placement.setAttribute('width', newWidth);
				}
			}

			window.updatePlacementHeights = (newHeight) => {
				const placements = getAllPlacements();

				for (const placement of placements) {
					placement.setAttribute('width', newHeight);
				}
			}
		</script>

	</head>
	<body>

		<template id="preview-page">
		</template>

		<header></header>
		<main>
			
			<!-- Page Controls -->
			<section>
				<label for="new-page-width">New Page Width</label> <input type="number" value="400" id="new-page-width">
				<label for="new-page-height">New Page Height</label> <input type="number" value="400" id="new-page-height">
				<button onclick="addPage()">Add Page</button>
			</section>

			<!-- Source Controls -->
			<section>
				<label for="source-page-width">Source Page Width</label>
				<input type="number" value="400" id="source-page-width" onChange="updatePlacementWidths(event.target.value)">

				<label for="source-page-height">Source Page Height</label>
				<input type="number" value="400" id="source-page-height" onChange="updatePlacementHeights(event.target.value)">
			</section>

			
			

			<!-- Where new pages get added -->
			<section id="pattern-preview">
			</section>


		</main>


	</body>
</html>
