
<!DOCTYPE html>
<html>
	<head>
		<title>Book Arranger</title>
		<link rel="stylesheet" href="main.css">

		<script type="module" src="PatternPage.js"></script>
		<script type="module">

			import { Placement } from './Placement.js'
			import { PatternPage } from './PatternPage.js'

			const pageWidth = 400;
			const pageHeight = 300;


			customElements.define("pattern-page", PatternPage);
			customElements.define("arranger-placement", Placement);


			/** Button Methods */
			window.addPage = () => {

				const pattern_page = document.createElement("pattern-page");
				pattern_page.setAttribute('width', pageWidth);
				pattern_page.setAttribute('height', pageHeight);

				document.querySelector("#pattern-preview").appendChild(pattern_page);
			}

			window.sourcePageWidthChanged = (newWidth) => {
			}

			window.sourcePageHeightChanged = (newHeight) => {
			}

			const getAllPlacements = () => {
				
				let allPlacements = [];

				const e = document.querySelector("#pattern-preview")

				for (const page of e.children) {
					const placements = page.shadowRoot.querySelector(".preview-page").children

					for (const placement of placements) {
						allPlacements.push(placement.shadowRoot);
						//placement.shadowRoot.querySelector(".placement").style.width = "100px";
						//console.log(placement.shadowRoot.querySelector(".placement"));
					}
					
				}

				return allPlacements;
				
			}

			window.updatePlacementWidths = (newWidth) => {
				const placements = getAllPlacements();

				for (const placement of placements) {
					placement.querySelector(".placement").style.width = `${newWidth}px`
				}
			}
		</script>

	</head>
	<body>

		<template id="preview-page">
		</template>

		<header></header>
		<main>
			
			<!-- Page Controls -->
			<button onclick="addPage()">Add Page</button>

			<!-- Source Controls -->
			<label for="source-page-width">Source Page Width</label>
			<input type="number" value="400" id="source-page-width" onChange="updatePlacementWidths(event.target.value)">

			<label for="source-page-height">Source Page Height</label>
			<input type="number" value="400" id="source-page-height">
			
			<button onClick="getAllPlacements()">Get all placements</button>

			<!-- Where new pages get added -->
			<section id="pattern-preview">
			</section>


		</main>


	</body>
</html>
